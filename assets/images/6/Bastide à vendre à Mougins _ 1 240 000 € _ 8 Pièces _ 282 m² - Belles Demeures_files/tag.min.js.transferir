/*! Copyright (c) 2022 Mediarithmics; All Rights Reserved */
(()=>{var i={2705:(t,e,i)=>{i=i(5639).Symbol;t.exports=i},6874:t=>{t.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}},4636:(t,e,i)=>{var d=i(2545),l=i(5694),p=i(1469),h=i(4144),f=i(5776),g=i(6719),_=Object.prototype.hasOwnProperty;t.exports=function(t,e){var i,n=p(t),o=!n&&l(t),r=!n&&!o&&h(t),s=!n&&!o&&!r&&g(t),a=n||o||r||s,c=a?d(t.length,String):[],u=c.length;for(i in t)!e&&!_.call(t,i)||a&&("length"==i||r&&("offset"==i||"parent"==i)||s&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||f(i,u))||c.push(i);return c}},4865:(t,e,i)=>{var o=i(9465),r=i(7813),s=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){var n=t[e];s.call(t,e)&&r(n,i)&&(void 0!==i||e in t)||o(t,e,i)}},9465:(t,e,i)=>{var n=i(8777);t.exports=function(t,e,i){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i}},4239:(t,e,i)=>{var n=i(2705),o=i(9607),r=i(2333),s=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(s&&s in Object(t)?o:r)(t)}},9454:(t,e,i)=>{var n=i(4239),o=i(7005);t.exports=function(t){return o(t)&&"[object Arguments]"==n(t)}},8458:(t,e,i)=>{var n=i(3560),o=i(5346),r=i(3218),s=i(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,i=Object.prototype,c=c.toString,i=i.hasOwnProperty,u=RegExp("^"+c.call(i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!r(t)||o(t))&&(n(t)?u:a).test(s(t))}},8749:(t,e,i)=>{var n=i(4239),o=i(1780),r=i(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return r(t)&&o(t.length)&&!!s[n(t)]}},313:(t,e,i)=>{var o=i(3218),r=i(5726),s=i(3498),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!o(t))return s(t);var e,i=r(t),n=[];for(e in t)("constructor"!=e||!i&&a.call(t,e))&&n.push(e);return n}},5976:(t,e,i)=>{var n=i(6557),o=i(5357),r=i(61);t.exports=function(t,e){return r(o(t,e,n),t+"")}},6560:(t,e,i)=>{var n=i(5703),o=i(8777),i=i(6557);t.exports=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:i},2545:t=>{t.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}},7518:t=>{t.exports=function(e){return function(t){return e(t)}}},8363:(t,e,i)=>{var u=i(4865),d=i(9465);t.exports=function(t,e,i,n){var o=!i;i=i||{};for(var r=-1,s=e.length;++r<s;){var a=e[r],c=n?n(i[a],t[a],a,i,t):void 0;void 0===c&&(c=t[a]),(o?d:u)(i,a,c)}return i}},4429:(t,e,i)=>{i=i(5639)["__core-js_shared__"];t.exports=i},1463:(t,e,i)=>{var n=i(5976),c=i(6612);t.exports=function(a){return n(function(t,e){var i=-1,n=e.length,o=1<n?e[n-1]:void 0,r=2<n?e[2]:void 0,o=3<a.length&&"function"==typeof o?(n--,o):void 0;for(r&&c(e[0],e[1],r)&&(o=n<3?void 0:o,n=1),t=Object(t);++i<n;){var s=e[i];s&&a(t,s,i,o)}return t})}},8777:(t,e,i)=>{var n=i(852),i=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},1957:(t,e,i)=>{i="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;t.exports=i},852:(t,e,i)=>{var n=i(8458),o=i(7801);t.exports=function(t,e){return e=o(t,e),n(e)?e:void 0}},9607:(t,e,i)=>{var n=i(2705),i=Object.prototype,r=i.hasOwnProperty,s=i.toString,a=n?n.toStringTag:void 0;t.exports=function(t){var e=r.call(t,a),i=t[a];try{var n=!(t[a]=void 0)}catch(t){}var o=s.call(t);return n&&(e?t[a]=i:delete t[a]),o}},7801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},5776:t=>{var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&n.test(t))&&-1<t&&t%1==0&&t<e}},6612:(t,e,i)=>{var o=i(7813),r=i(8612),s=i(5776),a=i(3218);t.exports=function(t,e,i){if(!a(i))return!1;var n=typeof e;return!!("number"==n?r(i)&&s(e,i.length):"string"==n&&e in i)&&o(i[e],t)}},5346:(t,e,i)=>{var i=i(4429),n=(i=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!n&&n in t}},5726:t=>{var i=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},3498:t=>{t.exports=function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}},1167:(t,e,i)=>{t=i.nmd(t);var i=i(1957),e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,o=n&&n.exports===e&&i.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t?t:o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5357:(t,e,i)=>{var c=i(6874),u=Math.max;t.exports=function(r,s,a){return s=u(void 0===s?r.length-1:s,0),function(){for(var t=arguments,e=-1,i=u(t.length-s,0),n=Array(i);++e<i;)n[e]=t[s+e];for(var e=-1,o=Array(s+1);++e<s;)o[e]=t[e];return o[s]=a(n),c(r,this,o)}}},5639:(t,e,i)=>{var n=i(1957),i="object"==typeof self&&self&&self.Object===Object&&self,i=n||i||Function("return this")();t.exports=i},61:(t,e,i)=>{var n=i(6560),n=i(1275)(n);t.exports=n},1275:t=>{var r=Date.now;t.exports=function(i){var n=0,o=0;return function(){var t=r(),e=16-(t-o);if(o=t,0<e){if(800<=++n)return arguments[0]}else n=0;return i.apply(void 0,arguments)}}},346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},3045:(t,e,i)=>{var n=i(8363),o=i(1463),r=i(1704),o=o(function(t,e){n(e,r(e),t)});t.exports=o},5703:t=>{t.exports=function(t){return function(){return t}}},7813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},2205:(t,e,i)=>{t.exports=i(3045)},6557:t=>{t.exports=function(t){return t}},5694:(t,e,i)=>{var n=i(9454),o=i(7005),i=Object.prototype,r=i.hasOwnProperty,s=i.propertyIsEnumerable,n=n(function(){return arguments}())?n:function(t){return o(t)&&r.call(t,"callee")&&!s.call(t,"callee")};t.exports=n},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,i)=>{var n=i(3560),o=i(1780);t.exports=function(t){return null!=t&&o(t.length)&&!n(t)}},4144:(t,e,i)=>{t=i.nmd(t);var n=i(5639),o=i(5062),i=e&&!e.nodeType&&e,e=i&&t&&!t.nodeType&&t,n=e&&e.exports===i?n.Buffer:void 0,n=n?n.isBuffer:void 0;t.exports=n||o},3560:(t,e,i)=>{var n=i(4239),o=i(3218);t.exports=function(t){return!!o(t)&&("[object Function]"==(t=n(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},1780:t=>{t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},3218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},6719:(t,e,i)=>{var n=i(8749),o=i(7518),i=i(1167),i=i&&i.isTypedArray,n=i?o(i):n;t.exports=n},1704:(t,e,i)=>{var n=i(4636),o=i(313),r=i(8612);t.exports=function(t){return r(t)?n(t,!0):o(t)}},5062:t=>{t.exports=function(){return!1}},2707:function(t,e,i){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o,r,s,a,c,u,d=i(5737),l=i(7238),p=i(2461),h=i(6701),f=i(971),e=i(2228),n=n(i(3045)),i="mics_debug_tag",i="1"===(new h.Cache).get(i)||"1"===(0,e.readCookie)(i)||!1,g=(0,p.Console)("tag",i),p=window.navigator.userAgent;function _(t){return void 0!==t.context}function v(e){f.mics._names.forEach(function(t){e(t)})}function m(e){v(function(t){t=f.mics[t];_(t)&&e(t)})}/googlebot|bingbot|yandexbot|baiduspider/i.test(p)||(o=!1,r=(new Date).getTime(),new d.AdServer(i).setDFPTargeting(),d={_tagVersion:"2.0.20220523-build-101-rev-1467b93",_setConfig:function(e){return m(function(t){return t.setConfig(e)})},_setInstallationId:function(e){return m(function(t){return t.setInstallationId(e)})},_declareAdvertisingCookieConsent:function(e){return m(function(t){return t.declareAdvertisingCookieConsent(e)})},_revokeAdvertisingCookieConsent:function(){return m(function(t){return t.revokeAdvertisingCookieConsent()})},_setEvaluator:function(e){return m(function(t){return t.setEvaluator(e)})},_setDeviceInfo:function(e){return m(function(t){return t.setDeviceInfo(e)})},_setSegmentDefinition:function(e){return m(function(t){return t.setSegmentDefinition(e)})},_setOperatorId:function(e,i){return m(function(t){return t.setOperatorId(e,i)})},_setUAID:function(e,i,n){return m(function(t){return t._setUAID(e,i,n)})},_reset:function(t){o&&!t||(o=!0,g.info("mics.reset"),m(function(t){return t._reset()}),s._startTime=r)}},(s=f.mics)._tagVersion||(0,n.default)(s,d),c=i,u=(a=s)._queue,v(function(t){a[t]&&_(a[t])||(a[t]=new l.TagObject(t,c),window[t]=a[t])}),v(function(t){!function(t,e){var i=f.mics[t];for(;e.length;){var n=e.shift();n&&_(i)&&(g.debug("executing ",n,"on",t),i.callMicsMethod(n.method,n.args))}}(t,u[t])}),d={_setConfig:d._setConfig,_setInstallationId:d._setInstallationId,_setSegmentDefinition:d._setSegmentDefinition,_setDeviceInfo:d._setDeviceInfo,_setEvaluator:d._setEvaluator},window.mics=window.mics||{},(0,n.default)(window.mics,d),window.addEventListener&&window.addEventListener("beforeunload",function(){m(function(t){return t.pageQuit()})},!1))},5737:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AdServer=void 0;var n=i(6701),o=i(2461),i=(r.prototype.setDFPTargeting=function(){var i=this;try{window.googletag&&window.googletag.cmd?window.googletag.cmd.push(function(){var t=i.cache.get("mics_sgmts"),t=t&&"string"==typeof t?JSON.parse(t):void 0,e=t||{};Object.keys(e).forEach(function(t){window.googletag.pubads().setTargeting("mics_"+t,e[t].map(String))})}):this.console.info("DFP is not present")}catch(t){this.console.error("error setting DFP",t)}},r);function r(t){this.debug=t,this.cache=new n.Cache(!0),this.console=(0,o.Console)("AdServer",t),this.console.info("Starting Ad Server Connection")}e.AdServer=i},6701:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var n=i(2461),i=(o.prototype.get=function(t){if(this.canUseLocalStorage)return window.localStorage.getItem(t)||void 0},o.prototype.store=function(t,e){this.canUseLocalStorage&&window.localStorage.setItem(t,e)},o.prototype.remove=function(t){this.canUseLocalStorage&&window.localStorage.removeItem(t)},o.prototype.isLocalStorageEnabled=function(){try{var t="is_enabled";return localStorage.setItem(t,"true"),"true"===localStorage.getItem(t)}catch(t){return this.debug&&console.log("localStorage is not enabled",t),!1}},o);function o(t){this.debug=!!t,this.console=(0,n.Console)(o.name,this.debug),this.canUseLocalStorage=this.isLocalStorageEnabled()}e.Cache=i},2461:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0;var a=i(971);e.Console=function(r,s){return function(t){var e,i={};for(e in t)i[t[e]]=function(o){return function(){if(s&&window.console&&Object.keys(window.console).includes(o))try{var t=Array.prototype.slice.apply(arguments),e=(new Date).getTime(),i=(0,a.durationFromSnippetStart)(e),n=i?i/1e3:0;t.unshift("ctx:".concat(r,"]")),t.unshift("[mics "+n.toFixed(3)+"s"),window.console[o].apply(window.console,t)}catch(t){window.console.log(t)}}}(t[e]);return i}("log debug info warn error".split(" "))}},2228:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(e.updateCookiesExpirationStartingWith=e.deleteCookiesStartingWith=e.readCookie=void 0,i(2461).Console)("CookieHelper",!1);function n(t,e){if(t&&e)for(var i=document.cookie.split(";"),n=0;n<i.length;n++){var o=i[n].replace(/ /g,"").split("=");o[0].startsWith(t)&&(r.debug("update cookie",o[0],o[1]),document.cookie=o[0]+"="+o[1]+";path=/;expires="+e)}}e.readCookie=function(t){for(var e=document.cookie.split(";"),i=0;i<e.length;i++){var n=e[i].replace(/ /g,"").split("=");if(n[0]===t)return r.debug("found cookie",n[0],n[1]),n[1]}},e.deleteCookiesStartingWith=function(t){var e=new Date;e.setTime(0),n(t,e.toUTCString())},e.updateCookiesExpirationStartingWith=n},517:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CookieMatcher=void 0;var s=i(2228),a=i(5098),c=i(2461),i=(n.prototype.setOperators=function(t){this.operators=t},n.prototype.setIsTcfEnabled=function(t){this.isTcfEnabled=t},n.prototype.end=function(){return this.gatherIdEnd},n.prototype.panicCallback=function(t){this.panicFn=t},n.prototype.setEtid=function(t){this.etid=t,this.finishIfPossible(!1)},n.prototype.isCookieMatchingAuthorizedByTcfApi=function(){return!this.isTcfEnabled||!!(this.tcfVendorMicsConsent&&this.tcfPurposesConsents||!1===this.gdprApplies)},n.prototype.destroy=function(){window.clearTimeout(this.watchDog)},n);function n(t,e,i,n,o){var r=this;this.gatherOperatorsIds=function(){r.console.info("gatherOperatorsIds",r.operators);for(var t=0;t<r.operators.length;t++)r.gatherId(r.operators[t]);0<r.timeout&&(r.watchDog=window.setTimeout(function(){r._timeout()},r.timeout))},this.gatherId=function(e){var t=r.options.gather_operator_id_url+"?opid="+e;r.isTcfEnabled&&(t=t+"&gdpr="+(!1===r.gdprApplies?"0":"1")),r.tcfstr&&r.isTcfEnabled&&(t=t+"&gdpr_consent="+r.tcfstr),r.options.override_transport&&r.options.override_transport(t),(0,a.loadScript)(t,function(t){t&&(r.console.info("error while gather_id",e),r.setOperatorId(e,null))})},this.setOperatorId=function(t,e){r.isCookieMatchingAuthorizedByTcfApi()&&(e?r.retrievedIds.includes(e)||(r.console.log("setId("+t+", "+e+")"),r.retrievedIds.push(e),r.finished=r.retrievedIds.length===r.operators.length,r.finishIfPossible(!1)):r.finishIfPossible(!1))},this.finishIfPossible=function(t){if(r.console.log("try to finish, panicMode:",t,"etid:",r.etid,"finished",r.retrievedIds.length),r.finished||t){r.gatherIdEnd=(new Date).getTime();for(var e=[];r.retrievedIds.length;){var i=r.retrievedIds.shift();i&&e.push(i)}r.console.log("finishing.");var n=r.options.cookie_matching_url+"?";r.etid&&(n=n+"etid="+r.etid+"&"),r.isTcfEnabled&&(n=n+"gdpr="+(!1===r.gdprApplies?"0":"1")+"&"),r.tcfstr&&(n=n+"gdpr_consent="+r.tcfstr+"&"),r.options.site_token&&(n=n+"$site_token="+r.options.site_token+"&"),r.options.datamart_token&&(n=n+"$dat_token="+r.options.datamart_token+"&");t=r.options.installation_id_namespace&&(0,s.readCookie)(r.options.installation_id_namespace);n=(n=t?n+"$ins="+t+"&":n)+"utidl="+e.join(","),r.options.override_transport&&r.options.override_transport(n),(0,a.loadScript)(n,function(t){t&&r.panicFn&&(r.console.info("failed to load get_id"),r.panicFn("$get_id_failed"))}),r.ran=!0,r.destroy()}},this._timeout=function(){r.isCookieMatchingAuthorizedByTcfApi()?r.finishIfPossible(!0):r.destroy()},this.finished=!1,this.ran=!1,this.operators=[],this.retrievedIds=[],this.timeout=t.global_timeout_ms,this.watchDog=void 0,this.options=t,this.console=(0,c.Console)("CookieMatcher",t.debug),this.tcfstr=o,this.tcfVendorMicsConsent=e,this.tcfPurposesConsents=i,this.gdprApplies=n}e.CookieMatcher=i},4471:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CurrentPage=void 0;var n=i(2228),i=(o.prototype._parseSearch=function(t){for(var e,i,n=t.substring(1).split("&"),o={},r=0;r<n.length;r++)e=(i=n[r].split("="))[0],i=i[1],o[e]=decodeURIComponent(i).replace(/\+/g," ");return o},o.prototype._setReady=function(){this.ready=!0},o.prototype.isReady=function(){return this.ready},o.prototype.readPage=function(){this.updatePage(),!this.options.local_cookie_name||(t=(0,n.readCookie)(this.options.local_cookie_name))&&(this.properties.raw_cookie=t);var t=(0,n.readCookie)("mics_uaid");t&&(this.properties.$uaid=t);t=(0,n.readCookie)("mics_vid");t&&this.userIdentifierHolder.addUserAgentIdentifier(t);t=this.options.installation_id_namespace&&(0,n.readCookie)(this.options.installation_id_namespace);t&&(this.properties.$ins=t);t=(0,n.readCookie)("mics_lts"),t=t&&parseInt(t,10);t&&!isNaN(t)&&(this.properties.$lts=t)},o.prototype.updatePage=function(){this.properties.$referrer=document.referrer,this.properties.$url=""+document.location,this._setUtm(),this._setGdpr()},o.prototype._setUtm=function(){for(var t="utm_source utm_medium utm_term utm_content utm_campaign".split(" "),e=this._parseSearch(window.location.search),i=0;i<t.length;i++){var n=t[i];e[n]&&(this.properties["$"+n]=e[n])}},o.prototype._setGdpr=function(){var t;window.__tcfapi&&(t=!(this.properties.$tcfapi=1)===this.gdprApplies?"0":"1",this.properties.$gdpr=t),this.tcfstr&&(this.properties.$gdpr_consent=this.tcfstr)},o.prototype.getVid=function(){return this.userIdentifierHolder.findVectorIdLongValue()},o.prototype.getInstallationid=function(){return this.userIdentifierHolder.findInstallationIdRawValue()},o.prototype.getLts=function(){return this.properties.$lts},o.prototype.getCookie=function(){return this.properties.$uaid},o.prototype.updateUAID=function(t,e){var i=new Date;i.setTime(i.getTime()+24*this.options.cookie_max_age_in_days*60*60*1e3),t&&(this.userIdentifierHolder.addUserAgentIdentifier(t),document.cookie="mics_vid="+encodeURIComponent(t)+";expires="+i.toUTCString()+";path=/"),e&&(this.properties.$lts=e,document.cookie="mics_lts="+encodeURIComponent(e)+";expires="+i.toUTCString()+";path=/"),this._setReady()},o.prototype.updateInstallationId=function(t){var e=new Date;e.setTime(e.getTime()+24*this.options.cookie_max_age_in_days*60*60*1e3),t&&(this.userIdentifierHolder.addUserAgentIdentifier("ins:".concat(t)),document.cookie=this.options.installation_id_namespace+"="+encodeURIComponent(t)+";expires="+e.toUTCString()+";path=/")},o);function o(t,e,i,n){this.properties={},this.options=t,this.ready=!1,this.tcfstr=n,this.gdprApplies=i,this.userIdentifierHolder=e}e.CurrentPage=i},8146:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventPusher=void 0;var c=i(2461),n=i(5098),s=i(971);function a(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}o.prototype.sendCallQueue=function(t,e){for(var i=this.callQueue,n=e||{};i.length;){var o=(0,s.durationFromSnippetStart)((new Date).getTime());o&&(n.$delay={$push:o,$start:(0,s.durationFromSnippetStart)(this.tagStart),$gather_id_end:(0,s.durationFromSnippetStart)(this.cookieMatcher.end()),$beacon:t===this.beacon});var r=a(r=i.shift()||{},this.globalProperties);r=a(r,n),r=a(r,this.userIdentifierHolder.getEventPusherProperties()),this.console.info("pushing",r);o=this.endPointUrl+"?"+this.generateHttpQuery(r);this.eventsRunning++,t(o,this.pixelSentCallback(this)),this.userPoint&&this.userPoint.addEvent(r)}this.panicMode||(this.console.info("complete before panicMode, clearing watchDog"),this.clearWatchDog())},o.prototype.clearWatchDog=function(){this.watchDog&&(this.console.log("clearing watchdog"),window.clearTimeout(this.watchDog),this.watchDog=void 0)},o.prototype.setPanicCallback=function(t){this.panicFn=t},o.prototype.triggerCallsIfPossible=function(){var t;this.console.info("trigger calls if possible: currentPage:",this.currentPage,"panicMode:",this.panicMode,", global:",this.globalProperties,"callQueue:",this.callQueue,"userIdentfiers:",this.userIdentifierHolder.userIdentifiers),(this.currentPage&&this.currentPage.isReady()||this.panicMode)&&(t={},this.panicMode&&this.panicReason&&(t.$error=this.panicReason),this.sendCallQueue(this.transportFunction||n.sendWithBeaconOrWithLoadPixel,t))},o.prototype.setUserpoint=function(t){this.userPoint=t},o.prototype.pixelSentCallback=function(i){return function(t,e){if(t?(i.eventsRunning--,i.console.info("error with",t)):(i.console.info("successfully sent",e),i.eventsRunning--),i.finishedCallbackFunction&&0===i.eventsRunning){i.console.info("calling callback function: eventsRunning:",i.eventsRunning,"errors:",i.errorEvents);try{i.finishedCallbackFunction.apply(0===i.errorEvents.length)}catch(t){i.console.error("error has occurred while calling callback function",t)}}}},o.prototype.pushDefault=function(){this.push("$page_view",void 0)},o.prototype.push=function(t,e){if(!this.currentPage)throw new Error("mics is not initialized, call mics.init(YOUR_TOKEN) first !");e=e||{},this.currentPage.properties.path!=document.location&&this.currentPage.updatePage(),(e=a(e,this.currentPage.properties)).$ev=t,this.callQueue.push(e),this.triggerCallsIfPossible()},o.prototype.addProperties=function(t){this.globalProperties=a(this.globalProperties,t),this.console.info("properties: ",this.globalProperties)},o.prototype.generateHttpQuery=function(t){var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&"object"!=typeof t[e]?i.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e])):"object"==typeof t[e]&&"object"==typeof JSON&&i.push(encodeURIComponent(e)+"=jso-"+encodeURIComponent(JSON.stringify(t[e])));return i.join("&")},o.prototype.panic=function(t){this.console.info("switching to panic mode ! reason:",t),this.panicMode=!0,this.panicReason=t,this.triggerCallsIfPossible()},o.prototype.onFinish=function(t,e){this.finishedCallbackFunction=t,this.setWatchDog(e)},o.prototype.beacon=function(t){navigator.sendBeacon(t)},o.prototype.pageQuit=function(){for(this.console.log("page is unloading"),this.console.log("send call queue with navigator.beacon ("+this.errorEvents.length+" events)");this.errorEvents.length;)this.beacon(this.errorEvents.shift());0<this.eventsRunning&&this.push("$quit_while_running",void 0),this.sendCallQueue(this.beacon,{$error:"page_quit"})},i=o;function o(t,e,i,n,o,r,s){var a=this;this.callQueue=[],this.setWatchDog=function(t){a.console.info("setup watchdog timer to ",t),a.clearWatchDog(),a.watchDog=setTimeout(function(){a.panic("$count_down_1")},t)},this.context=t,this.console=(0,c.Console)("EventPusher-"+t,r.debug),this.console.info("new EventPusher()"),this.callQueue=[],this.currentPage=i,this.transportFunction=r.overrideTransport,this.cookieMatcher=n,this.userPoint=o,this.tagStart=e,this.globalProperties={},this.eventsRunning=0,this.endPointUrl=r.endPointUrl,this.panicMode=!1,this.errorEvents=[],this.options=r,this.userIdentifierHolder=s}e.EventPusher=i},4836:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processExternalFeedsWith=e.processExternalFeeds=void 0;var s=i(5098),o=864e5;function a(t){var i={s:(t=t).s,hc:t.hc,c:t.c,p:t.p||o,st:t.st,dn:t.dn,cb:function(t){if(t&&"function"==typeof t)return t;return function(t,e){}}(t.cb),vid:t.vid,ot:t.ot},n=JSON.parse(i.s.getItem("_mediarithmics")),t=(n=n||{})[i.st];(!t||i.c.now()-t.lastFeedRefreshDate>i.p)&&(t="https://"+i.dn+"/v1/sites/"+i.st+"/external_feeds",i.vid&&(t=t+"?"+encodeURIComponent("$vid")+"="+encodeURIComponent(i.vid)),(i.ot||i.hc.get)(t,function(t,e){t?i.cb(t,null):!function(t){try{var e=JSON.parse(t);return Array.isArray(e.scripts)&&Array.isArray(e.feeds)}catch(t){return!1}}(e)?i.cb(null,e):(e=JSON.parse(e),n[i.st]={lastFeedRefreshDate:i.c.now()},i.s.setItem("_mediarithmics",JSON.stringify(n)),e.scripts.map(function(t){var e;"INLINE"===t.type?((e=document.createElement("script"))[void 0===e.innerText?"textContent":"innerText"]=t.inner,document.head.appendChild(e)):"SRC"===t.type?((e=document.createElement("script")).src=t.source,document.head.appendChild(e)):"IMG"===t.type&&i.hc.loadPixel(t.source,void 0)}),i.cb(null,e.feeds))}))}e.processExternalFeeds=function(t,e,i,n,o,r){a({s:window.localStorage?localStorage:{setItem:function(t,e){return null},getItem:function(t){return null}},hc:{get:s.get,loadPixel:s.loadPixel},c:Date,p:t,st:e,dn:i,cb:n,vid:o,ot:r})},e.processExternalFeedsWith=a},971:function(t,e){"use strict";var i=this&&this.__rest||function(t,e){var i={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(i[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(i[o[n]]=t[o[n]]);return i};Object.defineProperty(e,"__esModule",{value:!0}),e.durationFromSnippetStart=e.mics=void 0;var n,o=window.scimhtiraidem;if(!(o=!window.scimhtiraidem&&window.mics&&void 0!==window.mics._snippetVersion?{_queue:{mics:(n=window.mics)._queue},_names:["mics"],_snippetVersion:n._snippetVersion,_startTime:n._startTime,mics:i(n,["_queue","_snippetVersion","_startTime"])}:o))throw new Error("mics is not defined. Did you used the provided snippet ?");var r=o;e.mics=r,window.scimhtiraidem=r,e.durationFromSnippetStart=function(t){return t&&r&&t-r._startTime}},8902:function(t,i,e){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,s,a,c){return new(a=a||Promise)(function(i,e){function n(t){try{r(c.next(t))}catch(t){e(t)}}function o(t){try{r(c.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?i(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,o)}r((c=c.apply(t,s||[])).next())})},r=this&&this.__generator||function(i,n){var o,r,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(i,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(i,"__esModule",{value:!0}),i.ID5_REGISTRY_KEY=i.ID5_CONFIG_OVERRIDE_STORAGE_KEY=i.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME=i.MICS_PARTNER_ID=i.ID5_CDN_URL=void 0;var s=e(5098),a=e(2461),c=e(6701);i.ID5_CDN_URL="https://cdn.id5-sync.com/api/1.0/id5-api.js",i.MICS_PARTNER_ID=18,i.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME="$device_technical_id_mapping",i.ID5_CONFIG_OVERRIDE_STORAGE_KEY="mics_id5_config_override",i.ID5_REGISTRY_KEY=4;u.prototype.loadId5ApiJs=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return[4,Promise.resolve(this.id5Api)];case 1:if(t.sent())return[3,5];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,(0,s.loadScriptAsync)(i.ID5_CDN_URL)];case 3:return t.sent(),this.console.info("Loaded ".concat(i.ID5_CDN_URL)),this.id5Api=window.ID5,[3,5];case 4:return e=t.sent(),this.console.error("Could not load ID5 API",e),[3,5];case 5:return this.id5Api&&this.id5Api.loaded!==this.id5ApiLoadedAndReady&&(this.console.info("ID5.loaded=".concat(this.id5Api.loaded)),this.id5ApiLoadedAndReady=this.id5Api.loaded),[2]}})})},u.prototype.getID5ConfigOverride=function(){var e=this.cache.get(i.ID5_CONFIG_OVERRIDE_STORAGE_KEY);if(e)try{var t=JSON.parse(e);return this.console.log("ID5 config override found : ".concat(JSON.stringify(e))),t}catch(t){this.console.error("Cannot parse ID5 config override : ".concat(e))}return{}},u.prototype.initializeApi=function(){var t,e=this;!this.id5Status&&this.id5Api&&this.id5ApiLoadedAndReady&&(t=n(n({partnerId:i.MICS_PARTNER_ID},this.initialId5ApiConfig||{}),this.getID5ConfigOverride()),this.console.info("Initialize ID5 Api with config ".concat(JSON.stringify(t))),this.id5Api.debug=this.debug,this.id5Status=this.id5Api.init(t).onUpdate(function(t){e.console.log("ID5 ID updated callback",t),e.setId5UniversalId(t.getUserId())}),this.id5Status||this.console.warn("ID5 Api not initialized"))},u.prototype.setId5UniversalId=function(t){var e;t&&"0"!==t&&(this.console.info("Setting ID5 Id = ".concat(t)),this.id5UniversalId=t,e="net:".concat(i.ID5_REGISTRY_KEY,":").concat(t),this.userIdentifierHolder.legacyMode=!1,this.userIdentifierHolder.addUserAgentIdentifier(e),this.userIdentifierHolder.id5UserId=t,this.eventPusher.push(i.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME,{$type:"NETWORK_DEVICE_ID",$registry_key:i.ID5_REGISTRY_KEY,$value:e,$id:t}),this.eventPusher.triggerCallsIfPossible())},u.prototype.startGathering=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return this.console.info("Start gathering ID5 Id"),[4,this.loadId5ApiJs()];case 1:return t.sent(),this.initializeApi(),[2]}})})},e=u;function u(t){this.id5ApiLoadedAndReady=!1;var e=t.context,i=t.userIdentifierHolder,n=t.eventPusher,o=t.debug,t=t.initialId5ApiConfig;this.debug=o,this.userIdentifierHolder=i,this.eventPusher=n,this.console=(0,a.Console)("ID5IdGatherer-".concat(e),o),this.initialId5ApiConfig=t,this.cache=new c.Cache(o),this.id5Api=window.ID5,this.startGathering()}i.default=e},5098:(t,e)=>{"use strict";function i(e,i){var t=document.createElement("img");t.style.display="none",t.style.width=t.style.height="0px",i&&(t.onload=function(){i(void 0,e)},t.onerror=function(){var t=new Error("error while loading "+e);i(t,e)}),t.setAttribute("src",e)}function o(e,i){var t,n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.setAttribute("async","true"),i&&(n.onload=function(){i(void 0,e)},n.onerror=function(){var t=new Error("error while loading "+e);i(t,void 0)}),null!==(t=document.getElementsByTagName("script")[0].parentNode)&&void 0!==t&&t.appendChild(n)}Object.defineProperty(e,"__esModule",{value:!0}),e.sendWithBeaconOrWithLoadPixel=e.get=e.loadScriptAsync=e.loadScript=e.loadPixel=void 0,e.loadPixel=i,e.loadScript=o,e.loadScriptAsync=function(t){return new Promise(function(i,n){o(t,function(t,e){t&&n(t),i()})})},e.get=function(e,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){var t;4===n.readyState&&(200===n.status?i(void 0,n.responseText):(t=new Error("error while GETting: "+e),i(t,void 0)))},n.open("GET",e,!0),n.withCredentials=!0,n.send(null)},e.sendWithBeaconOrWithLoadPixel=function(t,e){if(!navigator.sendBeacon)return i(t,e);e(navigator.sendBeacon(t)?void 0:new Error("Error while calling "+t+"with sendBeacon()"),t)}},7238:function(t,e,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TagObject=void 0;var r=i(6701),s=i(517),c=i(2461),a=i(4471),u=i(5098),d=i(8146),l=i(4836),p=i(971),h=i(8713),f=i(2228),g=o(i(2205)),_=o(i(1216)),v=o(i(8902));function m(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}var i="https://cookie-matching.mediarithmics.com",y="mics_user_consent",b="mics_consent_ts",I=["VISIT","TOUCH"],E=(new Date).getTime(),P={domain_id:1,cookie_matching_url:i+"/v1/getids",gather_operator_id_url:i+"/v1/gather_id",get_id_path:"/v1/get_id",domain_name:"events.mediarithmics.com",protocol:"https://",events_path:"/v1/visits/pixel",config_server_path:"/v1/conf.js",cookie_max_age_in_days:365,cookie_refresh_in_days:10,local_cookie_name:void 0,gather_id_timeout_ms:2e3,global_timeout_ms:3e3,debug:!1,mode:"VISIT"},S={xandr:32,mediarithmics:184,google:755,id5:131},i=(w.prototype.fetchConfig=function(){var t="";this.options.site_token?(this.options=m(this.options,{installation_id_namespace:"mics_"+this.options.site_token}),t="?$site_token="+this.options.site_token+"&cb="+Date.now()):this.options.datamart_token&&(t="?$dat_token="+this.options.datamart_token+"&cb="+Date.now());t=this.options.protocol+this.options.domain_name+this.options.config_server_path+t;this.options.js_mock_params&&(t=t+"&"+this.options.js_mock_params),(0,u.loadScript)(t)},w.prototype.fetchScriptFromUri=function(t){(0,u.loadScript)(this.options.protocol+this.options.domain_name+t)},w.prototype.fetchScriptFromUrl=function(t){(0,u.loadScript)(t)},w.prototype.addPixel=function(t){t=this.options.protocol+this.options.domain_name+t;this.console.debug("Will load pixelUrl ".concat(t)),this.options.override_transport?this.options.override_transport(t):(0,u.loadPixel)(t)},w.prototype.call=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=Array.prototype.slice.apply(e).splice(0);this.callMicsMethod(t,n)},w.prototype.callMicsMethod=function(t,e){["init","call","config","push","pushDefault","addIdentifier","addProperties","addProperty","onFinish","onStart","_reset","syncFeeds"].includes(t)?this[t].apply(this,e):this.console.error("The method '"+t+"' is not supported.")},w.prototype.onStart=function(t){t&&t.apply()},w.prototype.setOperatorId=function(t,e){this.cookieMatcher&&this.cookieMatcher.setOperatorId(t,e)},w.prototype.getParamOrElse=function(t,e,i){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:i},w.prototype.clearWatchDog=function(){this.eventPusher&&this.eventPusher.clearWatchDog()},w.prototype.getTagConfigOverride=function(){var e=this.cache.get("mics_tag_config_override");if(e)try{var t=JSON.parse(e);return this.console.log("Tag Config override found : ".concat(JSON.stringify(t))),t}catch(t){this.console.error("Cannot parse tag config override : ".concat(e))}return{}},w.prototype.getTagOptionsOverride=function(){var e=this.cache.get("mics_tag_options_override");if(e)try{var t=JSON.parse(e);return this.console.log("Tag options override found : ".concat(JSON.stringify(t))),t}catch(t){this.console.error("Cannot parse tag options override : ".concat(e))}return{}},w.prototype.setConfig=function(t){var i=this,t=n(n({},t),this.getTagConfigOverride());this.currentPage&&(this.console.info("setConfig",t),t.audience_feeds_refresh_period&&this.addProperties({$audience_feeds_refresh_period:t.audience_feeds_refresh_period}),this.enable_local_segment_evaluation=this.getParamOrElse(t,"enable_local_segment_evaluation",!1),this.namespace=t.namespace||"",this.segment_evaluator_uri=t.segment_evaluator_uri||"",this.segment_evaluator_url=t.segment_evaluator_url||"",this.segment_definition_url=t.segment_definition_url||"",this.segment_definition_uri=t.segment_definition_uri||"",this.user_agent_info=t.user_agent_info||{},this.enableGOOMatching=this.getParamOrElse(t,"enable_goo_matching",!0),this.enableAPXMatching=this.getParamOrElse(t,"enable_apx_matching",!0),this.enableTcfForCookieMatching=this.getParamOrElse(t,"enable_tcf_v2_for_cookie_matching",!1),this.enableID5=this.getParamOrElse(t,"enable_id5",!1),this.enableID5&&(this.eventPusher?this.id5IdGatherer=new v.default({context:this.context,userIdentifierHolder:this.userIdentifierHolder,eventPusher:this.eventPusher,debug:this.debug,initialId5ApiConfig:this.getParamOrElse(t,"id5-init-config-override",{})}):this.console.warn("enable_id5 is true but eventPusher is null, cannot start id5 gathering")),this.cookieMatcher&&this.cookieMatcher.setIsTcfEnabled(this.enableTcfForCookieMatching||!1),this.fetchUAID(this.currentPage.getCookie(),this.currentPage.getVid(),this.currentPage.getLts()),this.enable_local_segment_evaluation&&(this.userpoint=new h.UserPoint(function(t,e){i.addPixel("/v1/edge/pixel?%24site_token="+i.options.site_token+"&%24seg_id="+t+"&%24o=a&%24vid="+encodeURIComponent(e))},function(t,e){i.addPixel("/v1/edge/pixel?%24site_token="+i.options.site_token+"&%24seg_id="+t+"&%24o=d&%24vid="+encodeURIComponent(e))},function(){i.enable_local_segment_evaluation&&i.userpoint&&i.computeSegments()},this.options.debug,this.namespace),this.eventPusher&&this.eventPusher.setUserpoint(this.userpoint),t=this.userIdentifierHolder.findVectorIdLongValue(),this.console.info("vector id",t),this.fetchScriptFromUri("/v1/device_info.js"),t&&this.userpoint.setAgent(t,this.user_agent_info),this.segment_evaluator_uri?this.fetchScriptFromUri(this.segment_evaluator_uri):this.segment_evaluator_url&&this.fetchScriptFromUrl(this.segment_evaluator_url),this.segment_definition_uri?this.fetchScriptFromUri(this.segment_definition_uri):this.segment_definition_url&&this.fetchScriptFromUrl(this.segment_definition_url)),this.eventPusher&&this.eventPusher.triggerCallsIfPossible())},w.prototype.setEvaluator=function(t){this.console.info("Setting Segment Evaluator"),"function"==typeof t&&(this.segment_evaluator=t),this.computeSegments()},w.prototype.setSegmentDefinition=function(t){this.console.info("Setting Segment Definition"),this.segment_definition=t.map,this.computeSegments()},w.prototype.setDeviceInfo=function(t){this.console.info("Setting Device Info"),this.device_info=t,this.userpoint&&this.userpoint.setAgent&&(this.userpoint.setAgent(this.userIdentifierHolder.findVectorIdLongValue(),this.device_info),this.computeSegments())},w.prototype.getConsentDate=function(t){var e=new Date,i=new Date(t),t=i.getTime();return 0<t&&t<e.getTime()?i:e},w.prototype.declareAdvertisingCookieConsent=function(t){var e=this.getConsentDate(t);this.cache.store(y,"true"),this.cache.store(b,e.getTime().toString());t=new Date;t.setTime(e.getTime()+31536e6),(0,f.updateCookiesExpirationStartingWith)("mics_",t.toUTCString())},w.prototype.revokeAdvertisingCookieConsent=function(){this.cache.store(y,"false"),this.cache.remove(b),(0,f.deleteCookiesStartingWith)("mics_")},w.prototype._setUAID=function(t,e,i){this.currentPage&&(e&&!this.set&&(this.set=!0,this.console.log("_setUAID(",e,i,")",this.userpoint),this.currentPage.updateUAID(e,i),this.enable_local_segment_evaluation&&this.userpoint&&this.user_agent_info&&this.userpoint.setAgent(e,this.user_agent_info)),this.eventPusher&&this.eventPusher.triggerCallsIfPossible(),this.syncFeedsCb&&(this.syncFeedsCb(),this.syncFeedsCb=void 0))},w.prototype.setInstallationId=function(t){var e;this.console.log("setInstalationId(".concat(t,")")),this.currentPage&&((e=this.currentPage.getInstallationid())?this.currentPage.updateInstallationId(e):this.currentPage.updateInstallationId(t))},w.prototype.hasPurposesConsents=function(t){return!!(t&&0<Object.keys(t).length&&Object.prototype.hasOwnProperty.call(t,"1")&&Object.prototype.hasOwnProperty.call(t,"3"))&&(t[1]&&t[3])},w.prototype.getVendorConsent=function(t,e){return!!(t&&0<Object.keys(t).length&&void 0!==t[e])&&t[e]},w.prototype.validateMode=function(t){if(!t||!I.includes(t))throw new Error("".concat(this.context,".init : invalid mode (").concat(t,")"))},w.prototype.handleTcfApi=function(){var i=this;window.__tcfapi&&(this.console.log("tcfapi detected"),window.__tcfapi("getTCData",2,function(t,e){e&&(i.tcfstr=t.tcString,i.gdprApplies=t.gdprApplies,t.purpose&&t.purpose.consents&&(i.tcfPurposesConsents=i.hasPurposesConsents(t.purpose.consents)),t.vendor&&t.vendor.consents&&(i.tcfVendorGoogleConsent=i.getVendorConsent(t.vendor.consents,i.vendorIds.google),i.tcfVendorXandrConsent=i.getVendorConsent(t.vendor.consents,i.vendorIds.xandr),i.tcfVendorMicsConsent=i.getVendorConsent(t.vendor.consents,i.vendorIds.mediarithmics)))}))},w.prototype.init=function(t){var e=this.initializeTagOptions(t);this.console.info("mcsObj.config, new configuration is",e),this.options=e,this.handleTcfApi();var i=null,t=null;if("VISIT"===e.mode?(i="/v1/visits/pixel",t=this.globalProperties.$site_token=e.site_token):"TOUCH"===e.mode&&(i="/v1/touches/pixel",t=this.globalProperties.$dat_token=e.datamart_token),void 0===this.eventPusher){if("string"!=typeof t)throw new Error(this.context+".init : the token must be a string");if(0===t.length)throw new Error(this.context+".init : the token must be a non-empty string");this.currentPage=new a.CurrentPage(e,this.userIdentifierHolder,this.gdprApplies,this.tcfstr),this.fetchConfig(),this.cookieMatcher=new s.CookieMatcher(e,this.tcfVendorMicsConsent,this.tcfPurposesConsents,this.gdprApplies,this.tcfstr),this.currentPage.readPage();i={endPointUrl:e.protocol+e.domain_name+i,debug:e.debug,overrideTransport:e.override_transport};this.eventPusher=new d.EventPusher(this.context,E,this.currentPage,this.cookieMatcher,this.userpoint,i,this.userIdentifierHolder),this.eventPusher.addProperties(this.globalProperties),this.eventPusher.setWatchDog(e.global_timeout_ms),this.cookieMatcher.panicCallback(this.eventPusher.panic.bind(this.eventPusher)),this.addProperty("$tv","2.0.20220523-build-101-rev-1467b93")}else this.console.warn(this.context+" was already initialized, stop initialization")},w.prototype.pageQuit=function(){this.eventPusher&&this.eventPusher.pageQuit()},w.prototype.onFinish=function(t,e){this.eventPusher&&this.eventPusher.onFinish(t,e)},w.prototype.pushDefault=function(){this.push("$page_view")},w.prototype.push=function(t,e){if(!this.eventPusher)throw new Error(this.context+" is not initialized, call "+this.context+".init(YOUR_TOKEN) first !");this.eventPusher.push(t,e)},w.prototype.addProperty=function(t,e){var i;this.console.debug("addProperty",t,e),"$user_account_id"===t?this.userIdentifierHolder.legacyUserAccountId=e:"$comp_token"===t?this.userIdentifierHolder.legacyCompartmentToken=e:"$email_hash"===t?this.userIdentifierHolder.legacyEmailHash=e:"$email"===t?this.userIdentifierHolder.legacyEmail=e:this.addProperties(((i={})[t]=e,i))},w.prototype.addProperties=function(t){this.console.debug("addProperties",t),this.eventPusher?this.eventPusher.addProperties(t):this.globalProperties=(0,g.default)(this.globalProperties,t)},w.prototype.addIdentifier=function(t,e){this.console.debug("addIdentifier(".concat(t,", ").concat(JSON.stringify(e),")"));try{if("USER_ACCOUNT"!=t&&"USER_EMAIL"!=t)throw new Error("Unsupported identifier type ".concat(t,', valid types are "USER_ACCOUNT" and "USER_EMAIL"'));var i=null!==e&&"string"==typeof e?e:JSON.stringify(e);this.userIdentifierHolder.legacyMode=!1,this.userIdentifierHolder.addIdentifierUnsafe(t,i)}catch(t){this.console.error(t)}},Object.defineProperty(w.prototype,"vid",{get:function(){return this.userIdentifierHolder.findVectorIdLongValue()},enumerable:!1,configurable:!0}),w.prototype._reset=function(){this.console.info("reset ",this.context),this.userpoint&&this.userpoint.reset(),this.set=!1,this.options=(0,g.default)({debug:this.options.debug},P),this.globalProperties={$sv:p.mics._snippetVersion},this.cookieMatcher=void 0,this.eventPusher=void 0,this.id5IdGatherer=void 0,this.currentPage=void 0,this.userpoint=void 0,this.userIdentifierHolder.reset(),this.tcfVendorXandrConsent=void 0,this.tcfVendorGoogleConsent=void 0,this.tcfVendorMicsConsent=void 0,this.tcfPurposesConsents=void 0,this.enableGOOMatching=void 0,(this.enableAPXMatching=void 0,f.deleteCookiesStartingWith)("mics_")},w.prototype.config=function(t){return this.options=(0,g.default)(this.options,t=t||{}),t.cookie_matching_url?this.console.info("overriding cookie_matching_url with ",t.cookie_matching_url):t.domain_name&&(this.options.cookie_matching_url=this.options.protocol+this.options.domain_name+this.options.get_id_path,this.console.info("using custom domain, cookie_matching_url will be ",this.options.cookie_matching_url)),this.console.info("mcsObj.config, new configuration is",this.options),this.options},w.prototype.syncFeeds=function(t){function e(){return(0,l.processExternalFeeds)(i.globalProperties.$audience_feeds_refresh_period,i.options.site_token,i.options.domain_name,t,i.userIdentifierHolder.findVectorIdLongValue(),i.options.override_transport||void 0)}var i=this;this.userIdentifierHolder.findVectorIdLongValue()?e():this.syncFeedsCb=e},w);function w(t,e){var a=this;this.enableID5=!1,this.fetchUAID=function(t,e,i){var n,o=new Date;o.setTime(o.getTime()-24*a.options.cookie_refresh_in_days*60*60*1e3);var r=[];!0===a.enableGOOMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorGoogleConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("goo"),!0===a.enableAPXMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorXandrConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("apx"),a.cookieMatcher&&a.cookieMatcher.setOperators(r),a.enable_local_segment_evaluation&&a.userpoint&&a.userpoint.getAgent&&(n=null===(n=a.userpoint)||void 0===n?void 0:n.getAgent()),e&&i&&(i>o.getTime()||n)?setTimeout(function(){a._setUAID(t,e,i)},0):a.cookieMatcher&&a.cookieMatcher.gatherOperatorsIds()},this.computeSegments=function(){var t,e,i,n,o,r,s=[];a.segment_definition&&a.segment_evaluator&&(e=null===(t=a.userpoint)||void 0===t?void 0:t.getUserPointData(),i=Object.keys(a.segment_definition),n=0,o=10,(r=function(){var t=n+o;i.slice(n,n+o).forEach(function(t){e&&a.segment_evaluator&&a.segment_evaluator(e,a.segment_definition[t])&&s.push(t)}),t<i.length?(n=t,setTimeout(r,100)):(a.console.info("Finished Computing Segments",s),a.userpoint&&a.userpoint.setSegments(s))})())},this.initializeTagOptions=function(t){var e;if(void 0===t)throw new Error(a.context+".init : use a token string or an object");return"string"==typeof t?e=m(a.options,{mode:"VISIT",site_token:t,domain_name:a.options.domain_name}):(a.validateMode(t.mode),e=m(a.options,t),t.cookie_matching_url?a.console.info("overriding cookie_matching_url with ",e.cookie_matching_url):e.domain_name&&(e.cookie_matching_url=e.protocol+e.domain_name+e.get_id_path,a.console.info("using custom domain, cookie_matching_url will be ",e.cookie_matching_url))),n(n({},e),a.getTagOptionsOverride())},this.context=t,this.namespace="",this.debug=e,this.console=(0,c.Console)(t,e),this.cache=new r.Cache(e),this.user_agent_info={},this.enable_local_segment_evaluation=!1,this.vendorIds=S,this.context=t,this.options=(0,g.default)(P,{debug:e}),this.globalProperties={$sv:p.mics._snippetVersion},this.get=u.get,this.processExternalFeeds=l.processExternalFeeds,this.processExternalFeedsWith=l.processExternalFeedsWith,this.userIdentifierHolder=new _.default(t,e),this.id5IdGatherer=void 0,this.syncFeedsCb=void 0,this.console.info("Creating tag object, globalProperties: ".concat(JSON.stringify(this.globalProperties)))}e.TagObject=i},1216:function(t,e,i){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=i(2461),r=["vec","ins","tech","web","etag","mob","net"];function s(i){return function(t){try{var e=JSON.parse(t);return i(e)?{parsed:e,hasError:!1}:{hasError:!0}}catch(t){return{hasError:!0,error:t}}}}function a(t){return null!==t&&"object"==typeof t&&("string"==typeof t.$user_account_id&&(!t.$compartment_token||"string"==typeof t.$compartment_token))}function c(t){return null!==t&&"object"==typeof t&&("string"==typeof t.$email_hash&&(!t.$email||"string"==typeof t.$email))}function u(t){return null!==t&&"object"==typeof t&&"string"==typeof t.$user_agent_id}d.prototype.reset=function(){this._userIdentifiers=[],this.legacyUserAccountId=void 0,this.legacyCompartmentToken=void 0,this.legacyEmailHash=void 0,this.legacyEmail=void 0,this.legacyMode=!0,this.console.info("Reset user identifiers")},Object.defineProperty(d.prototype,"userIdentifiers",{get:function(){return this.legacyUserAccountId&&(this.legacyCompartmentToken?this.addUserAccountIdentifier(this.legacyUserAccountId,this.legacyCompartmentToken):this.addUserAccountIdentifier(this.legacyUserAccountId)),this.legacyEmailHash&&this.addUserEmailIdentifier(this.legacyEmailHash,this.legacyEmail),this._userIdentifiers},enumerable:!1,configurable:!0}),d.prototype.getEventPusherProperties=function(){if(this.legacyMode){var t={},e=this.findVectorIdLongValue(),i=this.findInstallationIdRawValue();return e&&(t.$vid=e),i&&(t.$ins=i),this.legacyUserAccountId&&(t.$cuid=this.legacyUserAccountId),this.legacyCompartmentToken&&(t.$comp_token=this.legacyCompartmentToken),this.legacyEmailHash&&(t.$email_hash=this.legacyEmailHash),this.legacyEmail&&(t.$email=this.legacyEmail),this.id5UserId&&(t.$id5uid=this.id5UserId),t}return{$uids:this.toQueryObject()}},d.prototype.toQueryObject=function(){return this.userIdentifiers.map(function(t){switch(t.$type){case"USER_ACCOUNT":return{$tpe:"AC",$acid:t.$user_account_id,$ctok:t.$compartment_token};case"USER_EMAIL":return{$tpe:"EM",$eh:t.$email_hash,$e:t.$email};case"USER_AGENT":return{$tpe:"AG",$agid:t.$user_agent_id};default:return{$tpe:"NA"}}}).filter(function(t){return"NA"!==t.$tpe})},d.prototype.addUserAccountIdentifier=function(t,e){this.addIdentifier({$type:"USER_ACCOUNT",$user_account_id:t,$compartment_token:e})},d.prototype.addUserEmailIdentifier=function(t,e){this.addIdentifier({$type:"USER_EMAIL",$email_hash:t,$email:e})},d.prototype.parseUserAgentId=function(t){if(null!==t&&"string"==typeof t){var e={$type:"USER_AGENT"};return new RegExp(/^\d+$/).test(t)?n(n({},e),{$user_agent_id:"vec:".concat(t)}):r.includes(t.split(":")[0])?n(n({},e),{$user_agent_id:t}):void this.console.error("Unknown user agent id ".concat(t))}},d.prototype.addUserAgentIdentifier=function(t){this.console.debug("addUserAgentIdentifier(".concat(t,")"));t=this.parseUserAgentId(t);t&&this.addIdentifier(t)},d.prototype.findVectorIdStringValue=function(){var t=this._userIdentifiers.find(function(t){return"USER_AGENT"===t.$type&&t.$user_agent_id.startsWith("vec:")});return t&&t.$user_agent_id},d.prototype.findVectorIdLongValue=function(){var t=this.findVectorIdStringValue();return t&&t.split(":")[1]},d.prototype.findInstallationId=function(){var t=this._userIdentifiers.find(function(t){return"USER_AGENT"===t.$type&&t.$user_agent_id.startsWith("ins:")});return t&&t.$user_agent_id},d.prototype.findInstallationIdRawValue=function(){var t=this.findInstallationId();return t&&t.split(":")[1]},d.prototype.addIdentifier=function(e){var t=!1;switch(e.$type){case"USER_AGENT":t=!!this._userIdentifiers.find(function(t){return"USER_AGENT"===t.$type&&t.$user_agent_id===e.$user_agent_id});break;case"USER_ACCOUNT":t=!!this._userIdentifiers.find(function(t){return"USER_ACCOUNT"===t.$type&&t.$user_account_id===e.$user_account_id&&t.$compartment_token===e.$compartment_token});break;case"USER_EMAIL":t=!!this._userIdentifiers.find(function(t){return"USER_EMAIL"===t.$type&&t.$email_hash===e.$email_hash})}t||(this._userIdentifiers.push(e),this.console.log("New identifier ".concat(JSON.stringify(e)," added to user_identifiers ").concat(JSON.stringify(this._userIdentifiers))))},d.prototype.addIdentifierUnsafe=function(t,e){this.console.debug("addIdentifierUnsafe(".concat(t,", ").concat(e,")"));try{switch(t){case"USER_ACCOUNT":var i=s(a)(e);i.hasError?this.console.error("USER_ACCOUNT identifier invalid: ".concat(e)):this.addUserAccountIdentifier(i.parsed.$user_account_id,i.parsed.$compartment_token);break;case"USER_EMAIL":var n=s(c)(e);n.hasError?this.console.error("USER_EMAIL identifier invalid: ".concat(e)):this.addUserEmailIdentifier(n.parsed.$email_hash,n.parsed.$email);break;case"USER_AGENT":var o=s(u)(e);o.hasError?this.console.error("USER_AGENT identifier invalid: ".concat(e)):this.addUserAgentIdentifier(o.parsed.$user_agent_id);break;default:this.console.warn("Unhandled identifier type ".concat(t))}}catch(t){this.console.error("An unexpected error occured while calling addIdentifierUnsafe: ".concat(t))}},i=d;function d(t,e){this._userIdentifiers=[],this.legacyMode=!0,this.console=(0,o.Console)("UserIdentifierHolder-".concat(t),!!e)}e.default=i},8713:function(t,a,e){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(a,"__esModule",{value:!0}),a.UserPoint=a.MAX_EVENTS_FOR_USER_POINT=a.BASE_SEGMENTS_STORAGE_KEY=a.BASE_USERPOINT_STORAGE_KEY=void 0;var u=e(6701),d=e(2461);a.BASE_USERPOINT_STORAGE_KEY="_mics_up",a.BASE_SEGMENTS_STORAGE_KEY="mics_sgmts",a.MAX_EVENTS_FOR_USER_POINT=200;var l={profiles:[],segments:[],activities:[],events:[],emails:[],agents:[]},e=(i.prototype.reset=function(){this.userPointData=l,this.cache.remove(this.namespace+a.BASE_USERPOINT_STORAGE_KEY),this.cache.remove(a.BASE_SEGMENTS_STORAGE_KEY)},i.prototype.getUserPointData=function(){return this.userPointData},i.prototype.saveUserpoint=function(){var t=this.encrypt(this.userPointData);this.cache.store(this.namespace+a.BASE_USERPOINT_STORAGE_KEY,t);var e=this.cache.get(a.BASE_SEGMENTS_STORAGE_KEY),t=this.getSegmentIds()?this.getSegmentIds():[];e&&"object"==typeof e?e[this.namespace]=t:(e={})[this.namespace]=t,this.cache.store(a.BASE_SEGMENTS_STORAGE_KEY,JSON.stringify(e)),this.console.info("Saving UserPoint",this.userPointData)},i.prototype.setAgent=function(t,e){this.console.debug("setAgent(".concat(t,",").concat(JSON.stringify(e),")"));var i=t,n=e;e&&e!=={}||(n=this.getUserAgentInfo()),(i=!t||""===t?this.getAgent():i)&&n&&(n={id:"vec:"+t,creation_date:Date.now(),creation_ts:Date.now(),user_agent_info:n},this.userPointData.agents=[n],this.saveUserpoint())},i.prototype.getUserAgentInfo=function(){return this.userPointData.agents&&this.userPointData.agents.length&&this.userPointData.agents[0].user_agent_info&&(void 0!==this.userPointData.agents[0].user_agent_info||this.userPointData.agents[0].user_agent_info!=={})?this.userPointData.agents[0].user_agent_info:void 0},i.prototype.getAgent=function(){var t=this.userPointData.agents||[];if(t.length&&t[0].id){t=t[0].id.split(":");return t[t.length-1]}},i.prototype.getVectorId=function(){return this.userPointData.agents&&this.userPointData.agents.length?this.userPointData.agents[0].id:null},i.prototype.getSegmentIds=function(){return this.userPointData.segments.map(function(t){return t.id}).map(String)},i.prototype.formatEvent=function(t){return t.name=t.$ev,t.referrer=t.$referrer,t.date=Date.now(),t.url=t.$url,t.site_token=t.$site_token,delete t.$web_domain_token,delete t.$web_domain_id,delete t.$etag_id,delete t.$vector_last_seen,delete t.$tag_version,delete t.$delay,delete t.$error,delete t.$snippet_version,delete t.$check_cookie_drop_param,delete t.$consent_from_tcf_api,delete t.$gdpr_consent,delete t.$gdpr_applies,delete t.$installation_id,Object.assign(t,t.properties)},i.prototype.encrypt=function(t){return JSON.stringify(t)},i.prototype.decrypt=function(t){return JSON.parse(t)},i);function i(t,e,i,n,o){var s=this;this.userPointData=c({},l),this.setSegments=function(t){s.console.debug("setSegments(".concat(JSON.stringify(t),")"));var i,n=s.getSegmentIds(),o=t.filter(function(e){return!n.find(function(t){return e===t})}),r=n.filter(function(e){return!t.find(function(t){return e===t})});0!==o.length||0!==r.length?(s.userPointData.segments=t.map(function(t){return{id:t,creation_ts:Date.now(),last_modified_ts:Date.now(),expiration_ts:null}}),s.console.info("New Segments",o,"Removed Segments",r,"segments",t),s.saveUserpoint(),(i=function(t){var e=s.getVectorId();e?(s.console.log("found vectorId: "+e),s.onAddition&&o.forEach(function(t){s.onAddition(t,e)}),s.onDeletion&&r.forEach(function(t){s.onDeletion(t,e)})):0<t&&(s.console.log("could not find vectorId. retries left: "+t),setTimeout(i,1e3,t-1))})(5)):s.console.log("No new addition nor deletion, skipping...")},this.addEvent=function(t){s.console.debug("addEvent(".concat(JSON.stringify(t),")"));t=s.formatEvent(t);s.userPointData.events.unshift(t),s.userPointData.events=s.userPointData.events.slice(0,a.MAX_EVENTS_FOR_USER_POINT),s.saveUserpoint(),s.onEvent()},this.namespace=o,this.onAddition=t,this.onDeletion=e,this.onEvent=i,this.console=(0,d.Console)("UserPoint",n),this.cache=new u.Cache(n),this.console.info("Starting UserPoint System");n=this.cache.get(this.namespace+a.BASE_USERPOINT_STORAGE_KEY);if(n)try{var r=this.decrypt(n);this.console.debug("Existing user point found in localStorage : ".concat(JSON.stringify(r))),this.userPointData=r}catch(t){this.console.error("Failed to parse userpoint data in localStorage")}}a.UserPoint=e}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;e=n[t]={id:t,loaded:!1,exports:{}};return i[t].call(e.exports,e,e.exports,o),e.loaded=!0,e.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);o(2707)})();